"use strict";angular.module("devCooperation",["ngAnimate","ngCookies","ngSanitize","ngResource","ui.router","ui.bootstrap","leaflet-directive","ngTable","restangular","LocalStorageModule","smart-table","angularModalService","nya.bootstrap.select","base64","angularjs-dropdown-multiselect","angularFileUpload","ui.ace"]).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("api",{proRoute:"http://strl099049.mso.net:8080/ida-api/api",devRoute:"/api",isDev:!0}).config(["localStorageServiceProvider",function(e){e.setPrefix("devCooperation").setStorageType("sessionStorage").setStorageCookie(30,"/").setNotify(!0,!0)}]).config(["$httpProvider",function(e){e.interceptors.push(["$q","$location",function(e,t){return{responseError:function(o){var n=e.defer();return 401==o.status&&t.path("/logout"),n.reject(o),n.promise}}}])}]).run(["$rootScope","$location","localStorageService","$http","$templateCache","$state","socketService",function(e,t,o,n,r,i,s){e.currentUser=o.get("current-user")||null,e.currentUser||t.path("/login"),e.$on("$locationChangeStart",function(){n.defaults.headers.common.Authorization=o.get("current-user")?o.get("current-user").tokenId:"",e.currentUser?"/login"===t.path()&&t.path("/welcome"):t.path("/login"),"/logout"===t.path()&&(e.currentUser=null,o.remove("current-user"),s.disconnect(),t.path("/login"))}),e.redirectTo=function(e,o){null!=o&&Util.setSessionStorageItem("sourceUrl",o),t.path(e)}}]),angular.module("devCooperation").controller("uploadModalController",["$scope","$modalInstance","FileUploader","$state","localStorageService",function(e,t,o,n,r){e.cancel=function(){t.dismiss("cancel")};var i=e.uploader=new o({scope:e,url:"/api/containers/projectZip/upload",formData:[{projectId:n.params.projectId}],headers:{Authorization:r.get("current-user").tokenId}});i.onAfterAddingFile=function(){i.queue.length>1&&i.queue.splice(0,1)},e.close=function(){t.close()}}]),angular.module("devCooperation").controller("shareProjectModalController",["$scope","$modalInstance","modalShareProjectService","$state",function(e,t,o,n){e.showLoading=!1,e.createFailed=!1;var r=function(){e.arrUsers=[],e.arrSearchedUsers=[],o.getSharedUsers(n.params.projectId).then(function(t){t.forEach(function(t){e.arrUsers.push(t.sharedUser)})})};e.cancel=function(){t.dismiss("cancel")},e.addUser=function(){e.shareProjectForm.submitted=!0,e.showLoading=!0,o.addSharedUser(e.shareUserObj.id,n.params.projectId).then(function(t){t.bError?(e.errorMsg=t.message,e.createFailed=!0,e.showLoading=!1):e.arrUsers.push(e.shareUserObj)},function(){e.createFailed=!0,e.showLoading=!1})},e.searchUser=function(){e.shareUserObj&&(e.bShowSearchResult=!0,e.bSearchable=!1,e.createFailed=!1,o.searchUser(e.shareUserObj.username).then(function(t){t.searchText===e.shareUserObj.username&&(e.arrSearchedUsers=t)}))},e.chooseSearchedUser=function(t){e.shareUserObj=t,e.bSearchable=!0,e.bShowSearchResult=!1,console.log(t)},e.close=function(){t.close()},r()}]),angular.module("devCooperation").factory("modalShareProjectService",["$http","$q","api","Session",function(e,t,o,n){var r={},i=o.isDev?o.devRoute:o.proRoute;return r.getSharedUsers=function(o){var n=t.defer();return e.get(i+"/projectShares?filter[where][projectId]="+o+"&filter[include]=sharedUser").then(function(e){console.log(e),n.resolve(e.data)},function(e){n.resolve(e.data.error)}),n.promise},r.addSharedUser=function(o,n){var r=t.defer();return e.post(i+"/projectShares",{projectId:n,sharedUserId:o}).then(function(e){r.resolve(e.data)},function(e){r.resolve(e.data.error)}),r.promise},r.searchUser=function(o){var r=t.defer();return e.get(i+"/userModels?filter[where][id][neq]="+n.currentUser().userId+"&filter[where][username][like]=.*"+o+".*").then(function(e){e.data.searchText=o,r.resolve(e.data)},function(e){r.resolve(e.data.error)}),r.promise},r}]),angular.module("devCooperation").controller("registerModalController",["$scope","$modalInstance","$timeout","RegisterService",function(e,t,o,n){e.showLoading=!1,e.createFailed=!1,e.registerSuccess=!1,e.bPwcAccount=!0,e.newRegisterObj={},e.cancel=function(){t.dismiss("cancel")},e.changeAccountType=function(t){e.bPwcAccount=t},e.confirmPassword=function(){e.newRegisterObj.confirmPassword!=e.newRegisterObj.password?(e.createFailed=!0,e.errorMsg="Password not match"):e.createFailed=!1},e.register=function(){e.registerForm.submitted=!0,e.showLoading=!0,console.log(e.newRegisterObj),e.registerForm.$valid?n.register(e.newRegisterObj).then(function(t){e.successMsg=t.message,e.registerSuccess=!0,o(function(){e.cancel()},1500)},function(t){console.log(t),e.errorMsg=t.data.message,e.showLoading=!1,e.createFailed=!0}):(e.showLoading=!1,e.createFailed=!1)}}]),angular.module("devCooperation").factory("RegisterService",["$http","$q","api",function(e,t,o){var n={},r=o.isDev?o.devRoute:o.proRoute;return n.register=function(o){var n=t.defer();return e.post(r+"/userModels",o).then(function(e){console.log(e),n.resolve(e.data)},n.reject),n.promise},n}]),angular.module("devCooperation").controller("newProjectModalController",["$scope","$modalInstance","modalProjectService",function(e,t,o){e.showLoading=!1,e.createFailed=!1,e.cancel=function(){t.dismiss("cancel")},e.createProject=function(){if(e.newProjectForm.submitted=!0,e.showLoading=!0,e.newProjectForm.$valid){var n={name:e.newProjectObj.name,description:e.newProjectObj.description};o.createProject(n).then(function(o){o.bError?(e.errorMsg=o.message,e.createFailed=!0,e.showLoading=!1):t.close()},function(){e.createFailed=!0,e.showLoading=!1})}else e.showLoading=!1,e.createFailed=!1}}]),angular.module("devCooperation").factory("modalProjectService",["$http","$q","api",function(e,t,o){var n={},r=o.isDev?o.devRoute:o.proRoute;return n.createProject=function(o){var n=t.defer();return e.post(r+"/projects",o).then(function(e){n.resolve(e.data)},function(e){n.resolve(e.data.error)}),n.promise},n}]),angular.module("devCooperation").controller("inviteModalController",["$scope","$modalInstance","inviteService",function(e,t,o){e.createFailed=!1,e.cancel=function(){t.dismiss("cancel")},e.hostuser={name:"baron zhu",account:"host000",power:"ssss"},o.getInvitedUserInfoList().then(function(t){e.inviters=t},function(){}),e.addInviteUser=function(){if(!e.accountNum)return e.createFailed=!0,void(e.errorMsg="Please fill out this field");for(var t=0;t<e.inviters.length;t++)if(e.inviters[t].account==e.accountNum)return e.createFailed=!0,void(e.errorMsg="This inviter is already exists");e.createFailed=!1,o.addInvitedUsers(e.accountNum).then(function(t){e.inviters=t,e.accountNum=""},function(){})},e.removeInvitedUser=function(t){for(var n=[],r=0;r<o.testData.length;r++)o.testData[r].account!=t&&(n[n.length]=o.testData[r]);o.testData=n,e.inviters=n}}]),angular.module("devCooperation").factory("inviteService",["$http","$q","api",function(e,t,o){{var n={};o.isDev?o.devRoute:o.proRoute}return n.testData=[{name:"bzhu",account:"bzhu001",power:"ssss"},{name:"bzhu",account:"bzhu002",power:"ssss"},{name:"bzhu",account:"bzhu003",power:"ssss"},{name:"bzhu",account:"bzhu004",power:"ssss"},{name:"bzhu",account:"bzhu005",power:"ssss"},{name:"bzhu",account:"bzhu006",power:"ssss"}],n.addInvitedUsers=function(e){var o=t.defer(),r={name:"bzhu",account:e,power:"ssss"};return n.testData.push(r),o.resolve(n.testData),console.log(n.testData),o.promise},n.removeInvitedUser=function(e){for(var o=t.defer(),r=[],i=0;i<n.testData.length;i++)n.testData[i].account!=e&&(r[r.length]=n.testData[i]);return n.testData=r,o.resolve(n.testData),o.promise},n.getInvitedUserInfoList=function(){var e=t.defer();return e.resolve(n.testData),e.promise},n}]),angular.module("devCooperation").controller("confirmModalController",["$scope","$modalInstance","$state","confirmModalService",function(e,t,o,n){e.showLoading=!1,e.confirmEvent=function(){e.showLoading=!0,n.actionDo(e.paramData,e.confirmUrl).then(function(o){"true"==o.status?(t.close(),e.showLoading=!1):e.showLoading=!1})},e.cancel=function(){t.dismiss("cancel")}}]),angular.module("devCooperation").factory("confirmModalService",["$http","$q","api",function(e,t,o){var n={},r=o.isDev?o.devRoute:o.proRoute;return n.actionDo=function(o,n){var i=t.defer();return e.post(r+n,o).then(function(e){i.resolve(e.data)},i.reject),i.promise},n}]),angular.module("devCooperation").directive("vtreenode",["$compile","projectService",function(e,t){return{restrict:"E",scope:{nodes:"="},link:function(o,n){o.nodes=o.nodes.sort(function(e,t){return e.levelIndex-t.levelIndex});var r="<div class='vTreeNode-bar position-relative' ng-class='getClassByNode(node)' ng-repeat='node in nodes track by $index'><span ng-click='nodebarDisplay($event, node)' class='vTreeNode-title'>{{node.name}}</span><vtreenode nodes='node.nodes'></vtreenode></div>",i=angular.element(r);e(i)(o),n.append(i),o.getClassByNode=function(e){var t="";return t+=e.isFolder?"vTreeNode-folder ":"vTreeNode-file",t+=e.bOpen?"vTreeNode-open ":""},o.nodebarDisplay=function(e,o){o.isFolder?(o.bOpen=!o.bOpen,t.loadFolder(o)):t.loadFile(o)}}}}]),angular.module("devCooperation").directive("nouislider",function(){return{restrict:"A",scope:{option:"=",model:"="},link:function(e,t){var o=t[0];noUiSlider.create(o,e.option),angular.element(o).find(".noUi-handle").append('<div class="slider-tooltip-holder"><div class="slider-tooltip"></div></div><div class="slider-tooltip-arrow"></div>'),e.model.getSlider=function(){return o},e.model.setTooltipText=function(e){var t=angular.element(o).find(".slider-tooltip"),n=angular.element(o).find(".slider-tooltip-arrow");e.title||0===e.title?(t.show(),n.show(),e.start?t.text(e.title).css({marginLeft:"",marginRight:-e.start}):e.end?t.text(e.title).css({marginLeft:-e.end,marginRight:""}):t.text(e.title)):(t.hide(),n.hide())},e.model.disableAtValue=function(e){o.noUiSlider.set(e)},o.noUiSlider.on("update",function(t){e.model.updateValue?e.model.updateValue(t):e.model.setTooltipText("")}),e.model.init&&e.model.init()}}}),angular.module("devCooperation").directive("vmultidropdown",function(){return{restrict:"E",replace:!0,scope:{options:"=",config:"=",model:"="},link:function(e){e.itemChoosed="",e.bDisabled=!1,e.displayItemList=function(){e.showItemList=!e.showItemList,e.bShowAllItem=!1,e.itemListLimit=5},e.showAllItem=function(){e.bShowAllItem=!0,e.itemListLimit=e.arrData.length},e.getItemList=function(){e.itemChoosedList=[],e.arrData.forEach(function(t){t.checked&&e.itemChoosedList.push(t.name)}),e.allChecked=!0,e.filteredItems.forEach(function(t){t.checked||(e.allChecked=!1)}),e.itemChoosed=e.itemChoosedList.join(", ")},e.$watchCollection("options",function(t){e.$evalAsync(function(){e.arrData=[],t=t||[],"object"==typeof t[0]?e.arrData=t:t.forEach(function(t){e.arrData.push({name:t,checked:!1})})})}),e.checkAll=function(){e.filteredItems.forEach(function(t){t.checked=e.allChecked}),e.getItemList()},e.$watchCollection("filteredItems",function(t,o){o!==t&&e.$evalAsync(function(){e.allChecked=t.filter(function(e){return!e.checked}).length>0||0===t.length?!1:!0,t.length<=5?e.bShowAllItem=!0:5===e.itemListLimit&&(e.bShowAllItem=!1)})}),e.model.initDropdown=function(){e.showItemList=!1,e.itemChoosed="",e.itemChoosedList=[],e.arrData.forEach(function(e){e.checked=!1}),e.allChecked=!1,e.bShowAllItem=!1,e.itemListLimit=5,e.itemFilter=""},e.model.getSelectedResult=function(){return e.itemChoosedList},e.model.setDisabled=function(t){e.bDisabled=t}},templateUrl:"app/shared/vMultiDropdown/vMultiDropdown.html"}}),angular.module("devCooperation").controller("navbarCtrl",["$scope","$rootScope","Session","$state","$location",function(e,t,o,n,r){e.currentTabIndex=0,e.showSignoutPanel=!1,e.getHighlightedTab=function(t){return e.currentTabIndex===t?"nav-tab-highlight":""},e.turnToHomePage=function(){n.go(o.currentUser()?"welcome":"login")},e.logout=function(){r.path("/logout")},e.showSignoutMenu=function(){e.showSignoutPanel=!e.showSignoutPanel},$(document).bind("click",function(t){var o=$("#logout-container").find(t.target).length>0||$("#logout-container").attr("id")==$(t.target).attr("id");o||e.$apply(function(){e.showSignoutPanel=!1})})}]),angular.module("devCooperation").service("modalService",["$modal",function(e){var t={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"modal.html"},o={closeButtonText:"Close",actionButtonText:"OK",headerText:"Proceed?",bodyText:"Perform this action?"};this.showModal=function(e,t){return e||(e={}),e.backdrop="static",this.show(e,t)},this.show=function(n,r){var i={},s={};return angular.extend(i,t,n),angular.extend(s,o,r),i.controller||(i.controller=["$scope","$modalInstance",function(e,t){e.modalOptions=s,e.modalOptions.ok=function(e){t.close(e)},e.modalOptions.close=function(){t.dismiss("cancel")}}]),e.open(i).result}}]),angular.module("devCooperation").controller("filterBarController",["$scope",function(e){!function(){e.collapse=!0}();e.showFilter=function(){e.collapse=e.collapse?!1:!0}}]),angular.module("devCooperation").factory("welcomeService",["$http","$q","Session","api",function(e,t,o,n){var r={},i=n.isDev?n.devRoute:n.proRoute;return r.getProjectList=function(){var n=t.defer();return e.get(i+"/projects?filter[include]=owner&filter[where][ownerId]="+o.currentUser().userId).then(function(e){n.resolve(e.data)},n.reject),n.promise},r.getSharedProjectList=function(){var n=t.defer();return e.get(i+"/projectShares?filter[where][sharedUserId]="+o.currentUser().userId+"&filter[include][project]=owner").then(function(e){n.resolve(e.data)},n.reject),n.promise},r}]),angular.module("devCooperation").controller("welcomeCtrl",["$scope","$rootScope","$modal","$state","welcomeService","localStorageService",function(e,t,o,n,r,i){function s(){e.arrProjects=[],e.arrSharedProjects=[],r.getProjectList().then(function(t){e.arrProjects=t}),r.getSharedProjectList().then(function(t){t.forEach(function(t){t.project.bShared=!0,e.arrSharedProjects.push(t.project)})})}e.createProject=function(){var e=o.open({templateUrl:"new-project.html",controller:"newProjectModalController",windowClass:"new-project-form"});e.result.then(function(){s()},function(){})},e.openProject=function(e,t){i.remove("currentProjectInfo"),i.set("currentProjectInfo",{projectId:e,ownerId:t}),n.go("project",{projectId:e})},s()}]),angular.module("devCooperation").factory("commonHandlerService",[function(){var e={};return e.formatZero=function(e){return e>9?e:"0"+e},e}]),angular.module("devCooperation").factory("projectService",["$http","$q","Session","api","$rootScope",function(e,t,o,n,r){var i={},s=n.isDev?n.devRoute:n.proRoute;return i.getFileStructure=function(o){var n=t.defer();return e.get(s+"/fileStructures?filter[include]=owner&filter[include]=lastUpdatedBy&filter[where][projectId]="+o).then(function(e){n.resolve(e.data)},n.reject),n.promise},i.getFileStructureById=function(o){var n=t.defer();return e.get(s+"/fileStructures/"+o+"?filter[include]=owner&filter[include]=lastUpdatedBy&filter[include]=lockedBy").then(function(e){n.resolve(e.data)},n.reject),n.promise},i.loadFile=function(t){e.post(s+"/containers/getProjectFileByUrl",{fileUrl:t.fileUrl,fileId:t.id}).then(function(e){console.log(e),t=e.data.content.result.data;var o="";/.*\.(js|json)/gi.test(t.fileUrl)?o="javascript":/.*\.css/gi.test(t.fileUrl)?o="css":/.*\.scss/gi.test(t.fileUrl)?o="scss":/.*\.html/gi.test(t.fileUrl)&&(o="html"),r.$broadcast("project:loadFile",t,o)},function(e){console.log(e)})},i.loadFolder=function(e){r.$broadcast("project:loadFolder",e)},i.execBowerInstall=function(t){e.post(s+"/projects/execBowerInstall",{folderUrl:t.fileUrl}).then(function(e){console.log(e)},function(e){console.log(e)})},i.execNpmInstall=function(t){e.post(s+"/projects/execNpmInstall",{folderUrl:t.fileUrl}).then(function(e){console.log(e)},function(e){console.log(e)})},i.lockFile=function(n){var r=t.defer();return e.put(s+"/fileStructures",{id:n.id,isLocked:!0,lockedById:o.currentUser().userId}).then(function(e){r.resolve(e.data)},function(e){console.log(e)}),r.promise},i.saveFile=function(o){var n=t.defer();return e.put(s+"/fileStructures/saveFile",{fileId:o.id,fileContent:o.fileContent}).then(function(e){console.log(e),n.resolve(e.data)},function(e){console.log(e)}),n.promise},i}]),angular.module("devCooperation").controller("projectCtrl",["$scope","$rootScope","$modal","$state","projectService","socketService","localStorageService","Session",function(e,t,o,n,r,i,s,a){function l(){e.arrFileStructure=[],c={},e.bOwnerOfProject=a.currentUser().userId===s.get("currentProjectInfo").ownerId?!0:!1,r.getFileStructure(n.params.projectId).then(function(t){t.forEach(function(e){e.isFolder&&(e.bOpen=!1),c["nodeLevel"+e.level]?c["nodeLevel"+e.level].push(e):c["nodeLevel"+e.level]=[e]}),c.nodeLevel0&&(e.arrFileStructure=d(1,c.nodeLevel0[0].id))})}var c={},d=function(e,t){var o=[];return c["nodeLevel"+e]&&c["nodeLevel"+e].forEach(function(e){e.parentId==t&&(e.nodes=d(e.level+1,e.id),o.push(e))}),o};e.getAceReadonlyStatus=function(e){var t=!0;return e&&(t=!e.isLocked||e.lockedById!=a.currentUser().userId),t},e.getUnlockBtnStatus=function(e){var t=!0;return e&&(t=e.lockedById!=a.currentUser().userId),t},e.bowerInstall=function(){r.execBowerInstall(e.folderInfo)},e.npmInstall=function(){r.execNpmInstall(e.folderInfo)},e.lockFile=function(t){r.lockFile(t).then(function(o){r.getFileStructureById(o.id).then(function(o){i.getSocket().emit("add new team info","USER: "+o.lockedBy.username+"---> Locked a file to edit. File name: "+o.name),o.fileContent=t.fileContent,e.fileInfo=o})})},e.saveFile=function(e){r.saveFile(e).then(function(){})},e.uploadProject=function(){var e=o.open({templateUrl:"upload.html",controller:"uploadModalController",windowClass:"upload-form"});e.result.then(function(){l()},function(){})},e.shareProject=function(){var e=o.open({templateUrl:"share-project.html",controller:"shareProjectModalController",windowClass:"share-project-form"});e.result.then(function(){},function(){})},e.$on("project:loadFile",function(t,o,n){n||(n="javascript"),e.bFile=!0,e.fileInfo=o,e.editorMode={mode:n}}),e.$on("project:loadFolder",function(t,o){e.bFile=!1,e.folderInfo=o}),i.getSocket().on("add new team info",function(e){var t=angular.element(".project-team-info-holder");e.split("\n").forEach(function(e){t.append('<div class="project-team-info">'+e+"</div>")}),t.scrollTop(t.prop("scrollHeight"))}),l()}]),angular.module("devCooperation").service("Session",["localStorageService","$base64","$http",function(e){var t={};return t.create=function(t,o){e.set("current-user",{tokenId:t,userId:o})},t.destroy=function(){e.remove("current-user")},t.currentUser=function(){return e.get("current-user")},t}]),angular.module("devCooperation").factory("AuthService",["$http","$q","Session","api","socketService",function(e,t,o,n,r){var i={},s=n.isDev?n.devRoute:n.proRoute;return i.login=function(n){var i=t.defer();return e.post(s+"/userModels/login",n).then(function(t){o.create(t.data.id,t.data.userId),e.defaults.headers.common.Authorization=t.data.id,r.reconnect(),i.resolve(t.data)},i.reject),i.promise},i.isLoggedIn=function(){return!!o.currentUser()},i.register=function(o,n){var r=t.defer();return e.post(s+"/registerPwcUser/",{userName:o,accessCode:n}).then(function(e){r.resolve(e.data)},r.reject),r.promise},i}]),angular.module("devCooperation").controller("LoginController",["$scope","$rootScope","AUTH_EVENTS","AuthService","$state","$modal",function(e,t,o,n,r,i){function s(){e.loginFailed=!1,e.loginForm={username:"",password:""},e.showLoading=!1}s(),e.login=function(i){e.loginForm.submitted=!0,e.showLoading=!0,e.loginForm.$valid?n.login(i).then(function(n){console.log(n),t.$broadcast(o.loginSuccess),e.setCurrentUser(n),e.showLoading=!0,r.go("welcome")},function(n){e.loginFailed=!0,e.showLoading=!1,e.loginErrorMessage=n.data.message,t.$broadcast(o.loginFailed)}):(e.showLoading=!1,e.loginFailed=!1)},e.register=function(){e.loginFailed=!1;var t=i.open({templateUrl:"register.html",controller:"registerModalController",windowClass:"register-form"});t.result.then(function(){},function(){})}}]),angular.module("devCooperation").factory("socketService",["$http","$q","Session","api","$rootScope",function(e,t,o,n){var r=(n.isDev?n.devRoute:n.proRoute,{}),i=io.connect("http://localhost:3000"),s=function(){var e=o.currentUser();if(e){var t=e.tokenId,n=e.userId;i.on("connect",function(){i.emit("authentication",{id:t,userId:n}),i.on("authenticated",function(){console.log("User is authenticated")})})}};return r.reconnect=function(){i=io.connect("http://localhost:3000",{"force new connection":!0}),s()},r.disconnect=function(){i.disconnect()},r.getSocket=function(){return i},s(),r}]),angular.module("devCooperation").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"app/components/login/login.html",controller:"LoginController"}).state("project",{url:"/project/:projectId",templateUrl:"app/components/project/project.html"}).state("clients",{url:"/clients",templateUrl:"app/components/clients/clients.html"}).state("clients.detail",{url:"/:clientId",templateUrl:"app/components/clients/detail/detail.html"}).state("session",{url:"/clients/:clientId/session/:sessionId",templateUrl:"app/components/session/session.html"}).state("session.question",{url:"/:areaName/:areaId",templateUrl:"app/components/session/question/question.html"}).state("welcome",{url:"/welcome",templateUrl:"app/components/welcome/welcome.html"}).state("main",{url:"/main",templateUrl:"app/components/main/main.html"}),t.otherwise("/welcome")}]),angular.module("devCooperation").controller("ApplicationController",["$scope","$rootScope","AuthService","Session","$window","localStorageService",function(e,t,o,n,r){function i(){e.currentUser=n.currentUser()||null,e.isLoggedIn=o.isLoggedIn,t.showLoading=!1}e.setCurrentUser=function(e){t.currentUser=e},i(),r.onbeforeunload=function(){}}]).directive("includeReplace",function(){return{require:"ngInclude",restrict:"A",link:function(e,t){t.replaceWith(t.children())}}}),angular.module("devCooperation").run(["$templateCache",function(e){e.put("app/components/login/login.html",'<div class="content-holder login-container login-img" ng-controller="LoginController"><form name="loginForm" class="form-signin" role="form"><div class="login-content">Sign In</div><div class="form-item-msg alert alert-danger" ng-show="loginFailed">{{loginErrorMessage}}</div><div class="form-group" ng-class=\'currentInput==="username" ? "input-focus" : ""\'><div class="icon fa fa-user"></div><input class="form-control nombrelogin" name="username" placeholder="Username/Guid" ng-model="credentials.username" ng-focus="currentInput=\'username\'" required="" autofocus=""></div><div class="form-group" ng-class=\'currentInput==="password" ? "input-focus" : ""\'><div class="icon fa fa-unlock"></div><input type="password" class="form-control" name="password" placeholder="Password" ng-model="credentials.password" ng-focus="currentInput=\'password\'" required=""></div><div class="form-group"><button class="btn btn-default secondary-color sign-in" data-ng-click="login(credentials)"><span ng-if="!showLoading">SIGN IN</span><div ng-if="showLoading"><div class="loader"></div></div></button></div><p class="new-account-content" ng-click="register()">Create a New Account</p></form><div class="powered-content"><div class="powered-content-holder"><span>Created by</span><div class="pwc-small-logo pwc-logo-img"></div><span>Vian</span></div></div></div><script type="text/ng-template" id="modal.html"><div class="modal-header"> <h3>{{modalOptions.headerText}}</h3> </div> <div class="modal-body"> <p>{{modalOptions.bodyText}}</p> </div> <div class="modal-footer"> <button type="button" class="btn" data-ng-click="modalOptions.close()">{{modalOptions.closeButtonText}}</button> <button class="btn btn-primary" data-ng-click="modalOptions.ok();">{{modalOptions.actionButtonText}}</button> </div></script>'),e.put("app/components/project/project.html",'<div class="project-holder full-height" ng-controller="projectCtrl"><div class="top-bar"><button class="btn btn-danger btn-setup" ng-click="uploadProject()" ng-disabled="!bOwnerOfProject">Upload Project File</button> <button class="btn btn-danger btn-setup" ng-click="shareProject()" ng-disabled="!bOwnerOfProject">Share Project</button></div><div class="project-mid-holder"><div class="project-file-list-holder full-height pull-left"><vtreenode nodes="arrFileStructure"></vtreenode></div><div class="project-file-middle pull-left"><div class="project-file-tab-holder"></div><div class="project-file-content-holder"><div class="project-file-content-editor" ui-ace="editorMode" ng-model="fileInfo.fileContent" ng-readonly="getAceReadonlyStatus(fileInfo)"></div></div></div><div class="project-file-info-holder pull-right" ng-if="bFile"><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">File Name:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{fileInfo.name}}</div></div><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Owner:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{fileInfo.owner.username}}</div></div><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Create Date:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{fileInfo.createdAt | date:\'MM-dd-yyyy hh:mm\'}}</div></div><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Updated By:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{fileInfo.lastUpdatedBy.username}}</div></div><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Updated Date:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{fileInfo.updatedAt | date:\'MM-dd-yyyy hh:mm\'}}</div></div><hr><button class="btn btn-primary" ng-if="fileInfo.isLocked" ng-disabled="getUnlockBtnStatus(fileInfo)" ng-click="unlockFile(fileInfo)">Unlock</button> <button class="btn btn-danger" ng-if="!fileInfo.isLocked" ng-click="lockFile(fileInfo)">Lock</button> <button class="btn btn-success" ng-click="saveFile(fileInfo)">Save</button></div><div class="project-file-info-holder pull-right" ng-if="!bFile"><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Folder Name:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{folderInfo.name}}</div></div><div class="row"><div class="col-xs-5 project-file-info project-file-info-title">Create Date:</div><div class="col-xs-7 project-file-info project-file-info-content text-ellipsis">{{folderInfo.createdAt | date:\'MM-dd-yyyy hh:mm\'}}</div></div><hr><button class="btn btn-success" ng-click="bowerInstall()" ng-disabled="!bOwnerOfProject">Bower Install</button> <button class="btn btn-primary" ng-click="npmInstall()" ng-disabled="!bOwnerOfProject">Npm Install</button></div><div class="project-team-info-holder pull-right" ng-class=\'bFile ? "project-team-file-mode" : "project-team-folder-mode"\'><div class="project-team-info">Team Infomation :</div></div></div></div>'),e.put("app/components/welcome/welcome.html",'<div class="welcome-holder full-height" ng-controller="welcomeCtrl"><div class="top-bar"><button class="btn btn-danger btn-setup" ng-click="createProject()">Add Project</button></div><div class="welcome-mid-holder"><div class="project-holder col-xs-4" ng-repeat="project in arrProjects track by $index" ng-click="openProject(project.id, project.ownerId)"><div class="project-inner-holder"><div class="project-title-holder text-ellipsis">Project Name : {{project.name}}</div><div class="project-title-holder text-ellipsis">Created On : {{project.createdAt | date : \'MM-dd-yyyy hh:mm:ss\'}}</div><div class="project-title-holder text-ellipsis">Last Updated On : {{project.updatedAt | date : \'MM-dd-yyyy hh:mm:ss\'}}</div><div class="project-title-holder text-ellipsis">Created By : {{project.owner.username}}</div></div></div><div class="project-holder col-xs-4" ng-repeat="project in arrSharedProjects track by $index" ng-click="openProject(project.id, project.ownerId)"><div class="project-inner-holder"><div class="project-title-holder text-ellipsis">Project Name : {{project.name}}</div><div class="project-title-holder text-ellipsis">Created On : {{project.createdAt | date : \'MM-dd-yyyy hh:mm:ss\'}}</div><div class="project-title-holder text-ellipsis">Last Updated On : {{project.updatedAt | date : \'MM-dd-yyyy hh:mm:ss\'}}</div><div class="project-title-holder text-ellipsis">Created By : {{project.owner.username}}</div><div class="fa fa-share-alt project-share-icon" ng-if="!bShared"></div></div></div></div></div>'),e.put("app/shared/filterBar/filterBar.html",'<div ng-controller="filterBarController" class="filter-bar animate-show" ng-hide="collapse"><div class="filter-left"><div class="filter-top-holder"><span>Filters</span></div><div class="category-holder"><span>Category</span><div class="form-group category-row"><label>Level 1</label><select class="form-control"><option>All</option></select></div><div class="form-group category-row"><label>Level 2</label><select class="form-control"><option>All</option></select></div><div class="form-group category-row"><label>Level 3</label><select class="form-control"><option>All</option></select></div><div class="form-group category-row"><label>Level 4</label><select class="form-control"><option>All</option></select></div></div><div class="btn-holder text-center"><button class="btn btn-danger">Reset</button> <button class="btn btn-primary">Apply</button></div></div><div ng-class="collapse ? \'glyphicon-circle-arrow-right\' : \'glyphicon-circle-arrow-left\'" class="filter-arrow glyphicon text-center" ng-click="showFilter()"></div></div>'),e.put("app/shared/footBar/footBar.html",'<div class="foot-bottom">Â© 2015 PricewaterhouseCoopers LLP<div class="foot-img pwc-logo-img" ng-if="$root.currentUser"></div></div>'),e.put("app/shared/modal/modal.html",'<div class="modal-header"><h3>{{modalOptions.headerText}}</h3></div><div class="modal-body"><p>{{modalOptions.bodyText}}</p></div><div class="modal-footer"><button type="button" class="btn" data-ng-click="modalOptions.close()">{{modalOptions.closeButtonText}}</button> <button class="btn btn-primary" data-ng-click="modalOptions.ok();">{{modalOptions.actionButtonText}}</button></div>'),e.put("app/shared/navbar/navbar.html",'<nav class="navbar navbar-static-top" ng-controller="navbarCtrl"><div class="logo pull-left" ng-click="turnToHomePage()">Development Cooperation</div><div class="pull-right nav-tool" ng-show="$root.currentUser"><div class="logout-container pull-right" id="logout-container" ng-class="{\'menu-active\': showSignoutPanel}" ng-click="showSignoutMenu()"><div class="user-tool fa fa-user" title="Logout"></div><div class="signout-dropdown-menu" ng-show="showSignoutPanel" ng-click="logout()">Sign out</div></div><div class="alarm-tool fa fa-bell pull-right"></div></div></nav>'),e.put("app/shared/vMultiDropdown/vMultiDropdown.html",'<div class="vMulti-holder"><div class="input-group"><input type="text" class="form-control" readonly="" ng-model="itemChoosed" ng-disabled="bDisabled"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="displayItemList()" ng-disabled="bDisabled"><i class="glyphicon glyphicon-triangle-bottom"></i></button></span></div><div class="dropdown-list" ng-show="showItemList"><input type="text" class="form-control" placeholder="Enter Text to Search" ng-model="itemFilter"><div class="checkbox no-margin"><label><input type="checkbox" ng-model="allChecked" ng-click="checkAll()">(All)</label></div><div ng-repeat="item in (filteredItems = (arrData | filter:{name: itemFilter})) | limitTo: itemListLimit" class="checkbox no-margin"><label><input type="checkbox" ng-model="item.checked" ng-click="getItemList()">{{item.name}}</label></div><div class="btnShowAll" ng-hide="bShowAllItem" ng-click="showAllItem()">Show All {{config.itemName}} <span class="glyphicon glyphicon-chevron-down"></span></div></div></div>'),e.put("app/shared/directives/vTree/vTreeNode.html",'<div class="" ng-repeat="node in nodes track by $index | orderBy : node.levelIndex"><span>{{node.name}}</span><vtreenode nodes="node.nodes"></vtreenode></div>'),e.put("app/shared/modal/confirm/confirm-modal.html",'<script type="text/ng-template" id="confirm-modal.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <form name="confirmForm" id="confirm-form" class="form" role="form"> <div class="modal-body"> <div class="confirm-message">{{confirmMessage}}</div> <button class="submit-button ok " ng-click="confirmEvent()"> <span ng-if="!showLoading">OK</span> <div ng-if="showLoading"> <div class="loader"></div> </div> </button> <button class="submit-button cancel" ng-click="cancel()">Cancel</button> </div> <form></script>'),e.put("app/shared/modal/invite/invite-modal.html",'<script type="text/ng-template" id="invite-modal.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <div class="modal-header"> <div class="modal-title">Invite Users to "ABC Chemicals"</div> </div> <div class="modal-body"> <form name="inviteForm" id="invite-form" class="form" role="form"> <div class="invite-info"> <alert ng-if=\'createFailed\' type="danger" class="alert-meg">{{errorMsg}}</alert> <div class="infofill"> <input type="text" class="input-info" placeholder="Enter GUID..." ng-model="accountNum" /> </div> <input type="button" class="btn-addusers" value="Add Users" ng-click="addInviteUser()"/> </div> <div class="invite-user"> <div class="font-head">Total User: {{inviters.length}}</div> <div> <span class="font-username">{{hostuser.name}}</span> <br/> <span class="font-userinfo">{{hostuser.account}}</span> <br/> <span class="font-userinfo">{{hostuser.power}}</span> <br/> </div> <div ng-repeat="inviter in inviters"> <span class="font-username">{{inviter.name}}</span> <br/> <span class="font-userinfo">{{inviter.account}}</span> <br/> <span class="font-userinfo">{{inviter.power}}</span> <br/> <a ng-click="removeInvitedUser(inviter.account)" class="remove-link">Remove</a> </div> </div> <button class="submit-button done-button" ng-click="cancel()"> DONE </button> </form> </div></script>'),e.put("app/shared/modal/project/new-project-modal.html",'<script type="text/ng-template" id="new-project.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <div class="modal-header"> <div class="modal-title">New Project</div> </div> <div class="modal-body"> <form name="newProjectForm" id="new-project-form" class="form" role="form"> <alert ng-if=\'createFailed\' type="danger">{{errorMsg}}</alert> <div class="form-group" ng-class="{\'has-error\': submitted && newProjectForm.name.$invalid}"> <label for="project-name">Project Name</label> <input class="form-control" id="project-name" name="name" ng-model="newProjectObj.name" required autofocus> </div> <div class="form-group" ng-class="{\'has-error\': submitted && newProjectForm.description.$invalid}"> <label for="project-description">Description</label> <textarea class="form-control" id="project-description" name="description" rows=4 ng-model="newProjectObj.description" required> </textarea> </div> <button class="create-button submit-button" ng-click="createProject()"> <span ng-if="!showLoading">CREATE</span> <div ng-if="showLoading"> <div class="loader"></div> </div> </button> </form> </div></script>'),e.put("app/shared/modal/register/register-modal.html",'<script type="text/ng-template" id="register.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <div class="modal-header"> <div class="modal-title">Sign Up</div> </div> <div class="modal-body"> <div class="alert alert-success" ng-if="registerSuccess">{{successMsg}}</div> <form name="registerForm" id="register-form" class="form" role="form" ng-show="!registerSuccess"> <alert ng-if=\'createFailed\' type="danger">{{errorMsg}}</alert> <div class="form-group" ng-class="{\'has-error\': submitted && registerForm.username.$invalid}"> <input class="form-control register-input" id="register-username" name="username" placeholder="Guid" ng-model="newRegisterObj.username" required> </div> <div class="form-group" ng-class="{\'has-error\': submitted && registerForm.password.$invalid}"> <input class="form-control register-input" type="password" id="register-password" name="password" placeholder="Password" ng-model="newRegisterObj.password" required> </div> <button class="create-button submit-button" ng-click="register()"> <span ng-if="!showLoading">SIGN UP</span> <div ng-if="showLoading"> <div class="loader"></div> </div> </button> </form> </div></script>'),e.put("app/shared/modal/shareProject/share-project-modal.html",'<script type="text/ng-template" id="share-project.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <div class="modal-header"> <div class="modal-title">Share Project</div> </div> <div class="modal-body"> <form name="shareProjectForm" id="new-project-form" class="form position-relative" role="form"> <alert ng-if=\'createFailed && !bShowSearchResult\' type="danger">{{errorMsg}}</alert> <div class="form-group user-search-holder position-relative" ng-class="{\'has-error\': submitted && shareProjectForm.username.$invalid}"> <input class="form-control user-search" name="username" placeholder=\'User Name\' autocomplete=\'off\' ng-focus=\'searchUser()\' ng-model="shareUserObj.username" ng-keyup=\'searchUser()\'> <button class="btn btn-success user-search-btn" ng-click="addUser()" ng-disabled=\'!bSearchable\'> <span ng-if="!showSearchLoading">Share</span> <div ng-if="showSearchLoading"> <div class="loader"></div> </div> </button> </div> <div class=\'search-result-holder\' ng-if=\'arrSearchedUsers.length > 0 && bShowSearchResult\'> <div class=\'search-result\' ng-repeat=\'searchedUser in arrSearchedUsers track by $index\' ng-click=\'chooseSearchedUser(searchedUser)\'> <div class=\'search-result-name\'>{{searchedUser.username}}</div> <div class=\'search-result-date\'>Regested At : {{searchedUser.createdAt | date:\'MM-dd-yyyy\'}}</div> </div> </div> <table class="table table-striped user-table"> <thead> <td>GUID</td> <td>Regist Date</td> </thead> <tbody> <tr ng-repeat=\'user in arrUsers track by $index\'> <td>{{user.username}}</td> <td>{{user.createdAt | date:\'MM-dd-yyyy\'}}</td> </tr> </tbody> </table> <button class="create-button submit-button" ng-click="close()">CLOSE</button> </form> </div></script>'),e.put("app/shared/modal/upload/upload-modal.html",'<script type="text/ng-template" id="upload.html"><div class="close-button fa fa-times" ng-click="cancel()"></div> <div class="modal-header"> <div class="modal-title">Upload File</div> </div> <div class="modal-body"> <form name="uploadForm" id="upload-form" class="form" role="form"> <alert ng-if=\'createFailed\' type="danger">{{errorMsg}}</alert> <input type=\'file\' nv-file-select uploader="uploader" accept=\'.zip\' class=\'uploadZip\' multiple /> <table class="table"> <thead> <tr> <th width="50%">Name</th> <th ng-show="uploader.isHTML5">Size</th> <th ng-show="uploader.isHTML5">Progress</th> <th>Status</th> <th width="34%">Actions</th> </tr> </thead> <tbody> <tr ng-repeat="item in uploader.queue"> <td><strong>{{ item.file.name }}</strong></td> <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB </td> <td ng-show="uploader.isHTML5"> <div class="progress" style="margin-bottom: 0;"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': item.progress + \'%\' }"></div> </div> </td> <td class="text-center"> <span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span> <span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span> <span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span> </td> <td nowrap> <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess"> <span class="glyphicon glyphicon-upload"></span> Upload </button> <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading"> <span class="glyphicon glyphicon-ban-circle"></span> Cancel </button> <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()"> <span class="glyphicon glyphicon-trash"></span> Remove </button> </td> </tr> </tbody> </table> <button class="create-button submit-button" ng-click="close()"> <span>CLOSE</span> </button> </form> </div></script>')
}]);